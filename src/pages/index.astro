---
import { getImage } from "astro:assets";
import "../styles/global.css";
import Navbar from "@/components/layout/Navbar.astro";
import Hero from "@/components/sections/Hero.astro";
import WhatIDo from "@/components/sections/WhatIDo.astro";
import Projects from "@/components/sections/Projects.astro";
import Experience from "@/components/sections/Experience.astro";
import Organizations from "@/components/sections/Organizations.astro";
import Education from "@/components/sections/Education.astro";
import Trainings from "@/components/sections/Trainings.astro";
import Publications from "@/components/sections/Publications.astro";
import Contact from "@/components/sections/Contact.astro";
import profileImage from "@/assets/profile.webp";
import { withBase } from "@/lib/withBase";

const title = "Novanni Indi Pradana | Software Developer & Data Engineer";
const description =
  "Portfolio personal Novanni Indi Pradana - Software Developer & Data Engineer di BPS - Statistics Indonesia.";

const site = Astro.site ?? new URL("https://novanniindipradana.com");
const basePath = import.meta.env.BASE_URL ?? "/";
const siteUrl = site.origin;
const canonicalUrl = new URL(basePath, site).href;
const ogImage = await getImage({
  src: profileImage,
  width: 1200,
  quality: 92,
  format: "jpeg"
});
const ogImageUrl = new URL(ogImage.src, site).href;
const iconHref = withBase("logo.png");
---

<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script is:inline>
      (() => {
        try {
          const stored = localStorage.getItem("theme");
          const systemDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
          const theme = stored === "light" || stored === "dark" ? stored : (systemDark ? "dark" : "light");
          const root = document.documentElement;
          root.classList.toggle("dark", theme === "dark");
          root.setAttribute("data-theme", theme);
        } catch {}
      })();
    </script>

    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="author" content="Novanni Indi Pradana" />

    <link rel="canonical" href={canonicalUrl} />
    <meta name="robots" content="index, follow" />
    <meta name="referrer" content="strict-origin-when-cross-origin" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; img-src 'self' data: https:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; script-src 'self' 'unsafe-inline'; connect-src 'self'; base-uri 'self'; form-action 'self'; frame-ancestors 'none'; object-src 'none'"
    />

    <meta name="theme-color" content="#0f172a" media="(prefers-color-scheme: dark)" />
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)" />

    <script is:inline>
      document.documentElement.classList.add("has-js");
    </script>

    <link rel="icon" type="image/png" href={iconHref} />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:image" content={ogImageUrl} />
    <meta property="og:image:alt" content="Foto Novanni Indi Pradana" />
    <meta property="og:site_name" content="Novanni Indi Pradana" />
    <meta property="og:locale" content="id_ID" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageUrl} />
    <meta name="twitter:site" content="@pradanawae" />
    <meta name="twitter:creator" content="@pradanawae" />

    <script type="application/ld+json" is:inline>
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": "Person",
        name: "Novanni Indi Pradana",
        url: siteUrl,
        image: ogImageUrl,
        jobTitle: "Software Developer & Data Engineer",
        worksFor: {
          "@type": "Organization",
          name: "BPS - Statistics Indonesia"
        },
        sameAs: [
          "https://www.linkedin.com/in/novanniindipradana",
          "https://github.com/pradanain",
          "https://instagram.com/pradanawae"
        ]
      })}
    </script>
    <script type="application/ld+json" is:inline>
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": "WebSite",
        name: "Novanni Indi Pradana",
        url: siteUrl,
        description,
        inLanguage: "id-ID",
        publisher: {
          "@type": "Person",
          name: "Novanni Indi Pradana"
        }
      })}
    </script>
  </head>

  <body class="min-h-screen bg-background text-foreground antialiased">
    <a
      href="#main"
      class="sr-only focus:not-sr-only focus:fixed focus:left-4 focus:top-4 focus:z-50 focus:rounded-lg focus:bg-background focus:px-3 focus:py-2 focus:text-sm focus:shadow"
    >
      Lewati ke konten utama
    </a>

    <Navbar />

    <main id="main">
      <Hero />
      <WhatIDo />
      <Projects />
      <Experience />
      <Organizations />
      <Education />
      <Trainings />
      <Publications />
      <Contact />
    </main>

<footer class="border-t border-border/60 py-10">
  <div class="container">
    <p class="text-center text-sm text-muted-foreground">
      © 2026 Novanni Indi Pradana. All rights reserved.
    </p>
  </div>
</footer>


  </body>
</html>
